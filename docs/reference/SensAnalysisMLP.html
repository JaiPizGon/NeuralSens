<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function for evaluating the sensitivities of the inputs
  variables in a mlp model"><title>Sensitivity of MLP models — SensAnalysisMLP • NeuralSens</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity of MLP models — SensAnalysisMLP"><meta property="og:description" content="Function for evaluating the sensitivities of the inputs
  variables in a mlp model"><meta property="og:image" content="https://jaipizgon.github.io/NeuralSens/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NeuralSens</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/download.html">Download</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JaiPizGon/NeuralSens/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sensitivity of MLP models</h1>
      <small class="dont-index">Source: <a href="https://github.com/JaiPizGon/NeuralSens/blob/HEAD/R/SensAnalysisMLP.R" class="external-link"><code>R/SensAnalysisMLP.R</code></a></small>
      <div class="d-none name"><code>SensAnalysisMLP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for evaluating the sensitivities of the inputs
  variables in a mlp model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">trData</span>,</span>
<span>  actfunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  deractfunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preProc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for train</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  boot.R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boot.seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  boot.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for H2OMultinomialModel</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for H2ORegressionModel</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for list</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">trData</span>,</span>
<span>  <span class="va">actfunc</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mlp</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">trData</span>,</span>
<span>  preProc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for nn</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  preProc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for nnet</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">trData</span>,</span>
<span>  preProc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for nnetar</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">SensAnalysisMLP</span><span class="op">(</span></span>
<span>  <span class="va">MLP.fit</span>,</span>
<span>  .returnSens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .rawSens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sens_origin_layer <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  sens_origin_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sens_end_input <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">trData</span>,</span>
<span>  actfunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preProc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>MLP.fit</dt>
<dd><p>fitted neural network model</p></dd>


<dt>.returnSens</dt>
<dd><p>DEPRECATED</p></dd>


<dt>plot</dt>
<dd><p><code>logical</code> whether or not to plot the analysis. By default is
<code>TRUE</code>.</p></dd>


<dt>.rawSens</dt>
<dd><p>DEPRECATED</p></dd>


<dt>sens_origin_layer</dt>
<dd><p><code>numeric</code> specifies the layer of neurons with
respect to which the derivative must be calculated. The input layer is
specified by 1 (default).</p></dd>


<dt>sens_end_layer</dt>
<dd><p><code>numeric</code> specifies the layer of neurons of which
the derivative is calculated. It may also be 'last' to specify the output
layer (default).</p></dd>


<dt>sens_origin_input</dt>
<dd><p><code>logical</code> specifies if the derivative must be
calculated with respect to the inputs (<code>TRUE</code>) or output
(<code>FALSE</code>) of the <code>sens_origin_layer</code> layer of the model. By
default is <code>TRUE</code>.</p></dd>


<dt>sens_end_input</dt>
<dd><p><code>logical</code> specifies if the derivative calculated
is of the output (<code>FALSE</code>) or from the input (<code>TRUE</code>) of the
<code>sens_end_layer</code> layer of the model. By default is <code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to or from other methods</p></dd>


<dt>trData</dt>
<dd><p><code>data.frame</code> containing the data to evaluate the sensitivity of the model</p></dd>


<dt>actfunc</dt>
<dd><p><code>character</code> vector indicating the activation function of each
neurons layer.</p></dd>


<dt>deractfunc</dt>
<dd><p><code>character</code> vector indicating the derivative of the activation
function of each neurons layer.</p></dd>


<dt>preProc</dt>
<dd><p>preProcess structure applied to the training data. See also
<code><a href="https://rdrr.io/pkg/caret/man/preProcess.html" class="external-link">preProcess</a></code></p></dd>


<dt>terms</dt>
<dd><p>function applied to the training data to create factors. See
also <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></code></p></dd>


<dt>output_name</dt>
<dd><p><code>character</code> name of the output variable in order to
avoid changing the name of the output variable in <code>trData</code> to
'.outcome'</p></dd>


<dt>boot.R</dt>
<dd><p><code>int</code> Number of bootstrap samples to calculate. Used
to detect significant inputs and significant non-linearities. Only
available for <code>train</code> objects. Defaults to <code>NULL</code>.</p></dd>


<dt>boot.seed</dt>
<dd><p><code>int</code> Seed of bootstrap evaluations.</p></dd>


<dt>boot.alpha</dt>
<dd><p><code>float</code> Significance level of statistical test.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>SensMLP</code> object with the sensitivity metrics and sensitivities of
the MLP model passed to the function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In case of using an input of class <code>factor</code> and a package which
  need to enter the input data as matrix, the dummies must be created before
  training the neural network.</p>
<p>After that, the training data must be given to the function using the
  <code>trData</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a></h2>
    <p></p><ul><li><p>Plot 1: colorful plot with the classification
  of the classes in a 2D map</p></li>
<li><p>Plot 2: b/w plot with probability of the
  chosen class in a 2D map</p></li>
<li><p>Plot 3: plot with the stats::predictions of
  the data provided</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pizarroso J, Portela J, Muñoz A (2022). NeuralSens: Sensitivity Analysis of
Neural Networks. Journal of Statistical Software, 102(7), 1-36.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load data -------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"DAILY_DEMAND_TR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="va">DAILY_DEMAND_TR</span></span></span>
<span class="r-in"><span><span class="co">## Parameters of the NNET ------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">hidden_neurons</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">iters</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">decay</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#########################  REGRESSION NNET #####################################</span></span></span>
<span class="r-in"><span><span class="co">################################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Regression dataframe --------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Scale the data</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.tr</span> <span class="op">&lt;-</span> <span class="va">fdata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.tr</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fdata.Reg.tr</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.tr</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fdata.Reg.tr</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize the data for some models</span></span></span>
<span class="r-in"><span><span class="va">preProc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/preProcess.html" class="external-link">preProcess</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nntrData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">preProc</span>, <span class="va">fdata.Reg.tr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' ## TRAIN nnet NNET --------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create a formula to train NNET</span></span></span>
<span class="r-in"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">form</span>, sep <span class="op">=</span> <span class="st">" ~ "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nnetmod</span> <span class="op">&lt;-</span> <span class="fu">nnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">form</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">nntrData</span>,</span></span>
<span class="r-in"><span>                      linear.output <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      size <span class="op">=</span> <span class="va">hidden_neurons</span>,</span></span>
<span class="r-in"><span>                      decay <span class="op">=</span> <span class="va">decay</span>,</span></span>
<span class="r-in"><span>                      maxit <span class="op">=</span> <span class="va">iters</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2487.870002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1587.516208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1349.706741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1333.940734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1329.097060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1326.518168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1323.148574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1322.378769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1322.018091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1321.996301 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">nnetmod</span>, trData <span class="op">=</span> <span class="va">nntrData</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-plt img"><img src="SensAnalysisMLP-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-5-1 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $.outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD      TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.6120725 0.8274999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 4.7762243 4.8944193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 3.6045326 4.4670914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 3.0769395 3.3320326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 3.7486139 4.9043203</span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP to calculate sensitivities with respect to output of hidden neurones</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">nnetmod</span>, trData <span class="op">=</span> <span class="va">nntrData</span>,</span></span>
<span class="r-in"><span>                             sens_origin_layer <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                             sens_end_layer <span class="op">=</span> <span class="st">"last"</span>,</span></span>
<span class="r-in"><span>                             sens_origin_input <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                             sens_end_input <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 5 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation failed in `stat_density()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by error in `optimize()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> 'xmin' not less than 'xmax'</span>
<span class="r-plt img"><img src="SensAnalysisMLP-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-5-1 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $.outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Neuron 2.1 Neuron 2.2 Neuron 2.3 Neuron 2.4 Neuron 2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -7.059173   6.222473   3.443051   2.967425   2.773766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -7.059173   6.222473   3.443051   2.967425   2.773766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -7.059173   6.222473   3.443051   2.967425   2.773766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  -7.059173   6.222473   3.443051   2.967425   2.773766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -7.059173   6.222473   3.443051   2.967425   2.773766</span>
<span class="r-in"><span><span class="co">## Train caret NNET ------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create trainControl</span></span></span>
<span class="r-in"><span><span class="va">ctrl_tune</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"boot"</span>,</span></span>
<span class="r-in"><span>                                 savePredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                 summaryFunction <span class="op">=</span> <span class="fu">caret</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/caret/man/postResample.html" class="external-link">defaultSummary</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span> <span class="co">#For replication</span></span></span>
<span class="r-in"><span><span class="va">caretmod</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span>form <span class="op">=</span> <span class="va">DEM</span><span class="op">~</span><span class="va">.</span>,</span></span>
<span class="r-in"><span>                              data <span class="op">=</span> <span class="va">fdata.Reg.tr</span>,</span></span>
<span class="r-in"><span>                              method <span class="op">=</span> <span class="st">"nnet"</span>,</span></span>
<span class="r-in"><span>                              linout <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                                                    decay <span class="op">=</span> <span class="va">decay</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              maxit <span class="op">=</span> <span class="va">iters</span>,</span></span>
<span class="r-in"><span>                              preProcess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              trControl <span class="op">=</span> <span class="va">ctrl_tune</span>,</span></span>
<span class="r-in"><span>                              metric <span class="op">=</span> <span class="st">"RMSE"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 448.296994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 4.240464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 2.955813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.432667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.152339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.119534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.116452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.115042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.115024 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 259.256650 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 5.626711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 3.294659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.713958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.218022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.141379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.100764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.080285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.075813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.075489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.075479 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 839.080081 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 7.558987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.177089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.017037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.214439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.059848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.054339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.045965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.039738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.015979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1.990266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1.990266 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2367.468092 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 18.231718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 6.058120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.242985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.187840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.071775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.050664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.028564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.004616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1.984345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1.979182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1.979182 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 466.520607 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 26.340684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.710540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.505050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 3.920448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.611841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.175444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.114173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.113462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.113367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.113363 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 997.898260 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 7.946815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 3.796169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.732974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.185516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.016426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1.996298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1.984364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1.983086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1.983051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1.983051 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 926.945659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 8.424427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 3.640577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.446188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.280445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.270542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.265967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.255105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.247681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.244869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.244534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.244534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 142.892088 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 6.910998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.724961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.789805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 3.951995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.271814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.143636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.081638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.053068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.050443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.050366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.050366 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 224.855827 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 6.463371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 4.498606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.138860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.669166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.190129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.057145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.031552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.030720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.030692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.030691 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 56.501349 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 4.546989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 2.412030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.211975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.126688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.118982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.118522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.118318 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1537.541660 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 45.893358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 14.179474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 6.293025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.966490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.250200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.200879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.132716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.116182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.113110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.112921 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3354.677303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 8.207666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.979884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.402456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.680091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.140337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.120667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.090521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.072754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.064807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.063714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.063714 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1495.824272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 6.518061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 4.118493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.189918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.385578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.157477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.139096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.136309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.136306 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 11.757653 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 3.909688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 2.556194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.363998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.217477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.190203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.185572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.183208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.183205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 154.922979 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 5.007005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 2.986467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.324922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.096300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.077648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.071380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.070058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.070057 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1295.102618 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 20.587942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.648115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.498304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.651133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.284889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.195444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.167062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.151623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.147625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.147598 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 6196.422374 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 9.791647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 8.194195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 5.683012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.600464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.259054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.197961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.156120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.116732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.099782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.096804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.096804 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 165.586684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 6.965082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 2.942559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.400000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.192173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.147873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.145626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.144777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.144775 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3685.490536 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 7.497643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 4.678847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.198315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.332407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.266814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.246946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.230340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.225874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.223878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.223678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1883.675021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 9.414955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 6.244387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.029821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.441478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.388556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.310839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.223355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.200783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.161414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.149199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.149199 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2896.671370 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 5.948826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 3.887106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.866152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.358066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.269247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.244193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.236110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.235692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.235688 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1160.170910 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 31.153142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 11.439016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 5.790787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 3.100087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.444872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.285386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.154482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.141414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.136232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.135919 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3189.626236 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 5.430796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 3.625953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 2.730844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.340266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.247853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.174153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.141220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.127328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.098656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 2.071428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.071428 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 316.924838 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 5.937193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 4.755514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.663735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.233143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.134806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.113021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.101975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.100327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.100020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.100013 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1475.824755 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 6.897328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 5.017823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 3.550261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 2.277808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.126565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.103660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.089784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.089397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.089397 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2705.392001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 25.983461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 9.945895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 4.266584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 3.251963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 2.661341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 2.218021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 2.117866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 2.104051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 2.101507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 2.101324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">caretmod</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>minimum occurred at one end of the range</span>
<span class="r-plt img"><img src="SensAnalysisMLP-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-3-1 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $.outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.05494945 0.05477037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06038813 0.05438979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.05904747 0.06004020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.05927444 0.06659510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.05834915 0.04605626</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Train h2o NNET --------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create a cluster with 4 available cores</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html" class="external-link">h2o.init</a></span><span class="op">(</span>ip <span class="op">=</span> <span class="st">"localhost"</span>,</span></span>
<span class="r-in"><span>              nthreads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H2O is not running yet, starting it now...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note:  In case of errors look at the following log files:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     C:\Users\JPIZAR~1\AppData\Local\Temp\RtmpmwWafn\file165047a66f44/h2o_jpizarroso_started_from_r.out</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     C:\Users\JPIZAR~1\AppData\Local\Temp\RtmpmwWafn\file16506dba4019/h2o_jpizarroso_started_from_r.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting H2O JVM and connecting:  Connection successful!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R is connected to the H2O cluster: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster uptime:         2 seconds 810 milliseconds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster timezone:       Europe/Madrid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O data parsing timezone:  UTC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster version:        3.44.0.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster version age:    6 months and 4 days </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster name:           H2O_started_from_R_jpizarroso_inw091 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total nodes:    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total memory:   7.91 GB </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total cores:    20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster allowed cores:  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster healthy:        TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection ip:          localhost </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection port:        54321 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection proxy:       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Internal Security:      FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     R Version:                  R version 4.3.3 (2024-02-29 ucrt) </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Your H2O cluster version is (6 months and 4 days) old. There may be a newer version available.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Please download and install the latest version from: https://h2o-release.s3.amazonaws.com/h2o/latest_stable.html</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reset the cluster</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html" class="external-link">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdata_h2o</span> <span class="op">&lt;-</span> <span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.h2o.html" class="external-link">as.h2o</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fdata.Reg.tr</span>, destination_frame <span class="op">=</span> <span class="st">"fdata_h2o"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h2omod</span> <span class="op">&lt;-</span><span class="fu">h2o</span><span class="fu">::</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html" class="external-link">h2o.deeplearning</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                     distribution <span class="op">=</span> <span class="st">"AUTO"</span>,</span></span>
<span class="r-in"><span>                                     training_frame <span class="op">=</span> <span class="va">fdata_h2o</span>,</span></span>
<span class="r-in"><span>                                     standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                     activation <span class="op">=</span> <span class="st">"Tanh"</span>,</span></span>
<span class="r-in"><span>                                     hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">hidden_neurons</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     stopping_rounds <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                     epochs <span class="op">=</span> <span class="va">iters</span>,</span></span>
<span class="r-in"><span>                                     seed <span class="op">=</span> <span class="fl">150</span>,</span></span>
<span class="r-in"><span>                                     model_id <span class="op">=</span> <span class="st">"nnet_h2o"</span>,</span></span>
<span class="r-in"><span>                                     adaptive_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                     rate_decay <span class="op">=</span> <span class="va">decay</span>,</span></span>
<span class="r-in"><span>                                     export_weights_and_biases <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">h2omod</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in value[[3L]](cond):</span> The training data has not been detected, load the data to the h2o cluster</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Turn off the cluster</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html" class="external-link">h2o.shutdown</a></span><span class="op">(</span>prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">fdata_h2o</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Train RSNNS NNET ------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Normalize data using RSNNS algorithms</span></span></span>
<span class="r-in"><span><span class="va">trData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">RSNNS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/normalizeData.html" class="external-link">normalizeData</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">trData</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RSNNSmod</span> <span class="op">&lt;-</span><span class="fu">RSNNS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/mlp.html" class="external-link">mlp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">trData</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">trData</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                           y <span class="op">=</span> <span class="va">trData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                           size <span class="op">=</span> <span class="va">hidden_neurons</span>,</span></span>
<span class="r-in"><span>                           linOut <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                           learnFuncParams<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">decay</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           maxit<span class="op">=</span><span class="va">iters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">RSNNSmod</span>, trData <span class="op">=</span> <span class="va">trData</span>, output_name <span class="op">=</span> <span class="st">"DEM"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-plt img"><img src="SensAnalysisMLP-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-5-1 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DEM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD      TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.6822845 1.0399880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.6925971 1.0693525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.4945469 1.0524738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.4650314 0.8402342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.4720409 0.9847080</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## USE DEFAULT METHOD ----------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">caretmod</span><span class="op">$</span><span class="va">finalModel</span><span class="op">$</span><span class="va">wts</span>,</span></span>
<span class="r-in"><span>                            trData <span class="op">=</span> <span class="va">fdata.Reg.tr</span>,</span></span>
<span class="r-in"><span>                            mlpstr <span class="op">=</span> <span class="va">caretmod</span><span class="op">$</span><span class="va">finalModel</span><span class="op">$</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>                            coefnames <span class="op">=</span> <span class="va">caretmod</span><span class="op">$</span><span class="va">coefnames</span>,</span></span>
<span class="r-in"><span>                            actfun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>,<span class="st">"sigmoid"</span>,<span class="st">"linear"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            output_name <span class="op">=</span> <span class="st">"DEM"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-plt img"><img src="SensAnalysisMLP-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-3-1 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DEM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.06229568 0.05690481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06133223 0.05872422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.06134104 0.05680759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.06159004 0.05322817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.06092965 0.06176240</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#########################  CLASSIFICATION NNET #################################</span></span></span>
<span class="r-in"><span><span class="co">################################################################################</span></span></span>
<span class="r-in"><span><span class="co">## Regression dataframe --------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Scale the data</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.cl</span> <span class="op">&lt;-</span> <span class="va">fdata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.cl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fdata.Reg.cl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.cl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fdata.Reg.cl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize the data for some models</span></span></span>
<span class="r-in"><span><span class="va">preProc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/preProcess.html" class="external-link">preProcess</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nntrData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">preProc</span>, <span class="va">fdata.Reg.cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Factorize the output</span></span></span>
<span class="r-in"><span><span class="va">fdata.Reg.cl</span><span class="op">$</span><span class="va">DEM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span><span class="op">$</span><span class="va">DEM</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize the data for some models</span></span></span>
<span class="r-in"><span><span class="va">preProc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/preProcess.html" class="external-link">preProcess</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nntrData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">preProc</span>, <span class="va">fdata.Reg.cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Train caret NNET ------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create trainControl</span></span></span>
<span class="r-in"><span><span class="va">ctrl_tune</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"boot"</span>,</span></span>
<span class="r-in"><span>                                 savePredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                 summaryFunction <span class="op">=</span> <span class="fu">caret</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/caret/man/postResample.html" class="external-link">defaultSummary</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span> <span class="co">#For replication</span></span></span>
<span class="r-in"><span><span class="va">caretmod</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span>form <span class="op">=</span> <span class="va">DEM</span><span class="op">~</span><span class="va">.</span>,</span></span>
<span class="r-in"><span>                                data <span class="op">=</span> <span class="va">fdata.Reg.cl</span>,</span></span>
<span class="r-in"><span>                                method <span class="op">=</span> <span class="st">"nnet"</span>,</span></span>
<span class="r-in"><span>                                linout <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">hidden_neurons</span>,</span></span>
<span class="r-in"><span>                                                      decay <span class="op">=</span> <span class="va">decay</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                maxit <span class="op">=</span> <span class="va">iters</span>,</span></span>
<span class="r-in"><span>                                preProcess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                trControl <span class="op">=</span> <span class="va">ctrl_tune</span>,</span></span>
<span class="r-in"><span>                                metric <span class="op">=</span> <span class="st">"Accuracy"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3772.842618 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1557.564302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1214.199134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1110.296648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1070.982383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1040.282432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1026.243143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1022.185164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1018.932608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1014.806386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1012.499658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1012.499658 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2668.172951 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1496.742417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1187.526898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1050.272689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1013.322223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 996.639753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 979.316887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 969.798307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 966.613930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 965.693488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 965.463123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 965.463123 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3297.203342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1377.287449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1112.310755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1023.822455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 991.843628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 956.727170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 941.910334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 936.609226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 935.410703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 935.163698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 935.127337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 935.127337 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3568.399296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1489.763894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1219.257218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1076.771253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1024.503423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 998.708032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 981.840999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 973.720379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 971.090791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 968.967523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 968.494390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 968.494390 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3003.535668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1439.044442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1176.600696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1048.481267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1016.572547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1011.297145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 999.404464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 988.451143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 977.282991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 972.906275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 971.896597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 971.896597 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3408.995747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1341.622904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1089.969900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1029.207268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 996.486089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 988.952619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 976.464472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 972.214434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 970.881761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 969.641644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 969.485114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 969.485114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 4281.102149 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1513.066785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1329.056483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1209.982389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1118.764207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1076.036468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1061.718419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1050.693937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1040.872146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1029.507488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1025.374541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1025.374541 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3265.828022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1456.434584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1166.808947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1057.977863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1008.996008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 978.114751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 970.985521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 966.104095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 963.006874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 962.094607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 961.841612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 961.841612 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3019.717560 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1333.523881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1154.064664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1067.529755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1054.332888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1049.493394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1042.420751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1025.594053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1018.729658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1016.946541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1015.397734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1015.397734 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3405.760894 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1597.431168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1263.793552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1114.159495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1048.729401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1023.871076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 976.998748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 960.770263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 954.884250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 952.488444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 951.344477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 951.344477 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3013.688100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1535.862594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1231.453772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1132.096002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1106.684078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1083.676956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1041.694085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1032.125938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1022.027396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1006.266589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1000.802958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1000.802958 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 4628.455991 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1552.025703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1211.906415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1084.177292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1064.063606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1055.265752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1049.279896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1040.272607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1038.639372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1038.099537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1037.787531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1037.787531 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 2860.694342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1511.390857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1168.419352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1094.111978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1073.168803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1069.749263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1066.180221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1064.629158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1064.226117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1063.853095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1062.896671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1062.896671 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3377.433754 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1446.109214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1171.013957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1114.422290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1085.906251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1056.654790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1043.204252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1039.982529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1037.244251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1036.464530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1036.224249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1036.224249 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3253.715832 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1411.560701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1173.605210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1141.598323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1110.027489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1075.678228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1065.287014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1061.607689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1054.627824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1034.673250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1029.300197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1029.300197 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3863.665785 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1387.778891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1141.991241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1113.544623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1093.112775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1064.466827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1053.501083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1035.802924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1020.443915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1015.693675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1014.111725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1014.111725 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3378.665527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1400.194414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1134.238327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1072.434905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1022.352730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1009.326061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1003.254602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 998.622585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 996.924622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 995.431517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 995.296204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 995.296204 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3778.883814 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1287.189554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1085.911856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1048.258887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1031.285258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1020.746772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1009.982512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1001.117193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 996.249854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 995.002293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 994.464160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 994.464160 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3120.123677 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1354.765028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1127.326225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1030.192879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 995.812629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 987.332787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 980.506578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 976.439833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 975.171226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 974.762849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 974.669379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 974.669379 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 4498.743913 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1444.335556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1196.519410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1099.018244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1029.077344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1005.258084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 997.634916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 996.394696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 995.712015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 995.645881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 995.634593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 995.634593 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 4178.969476 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1484.773196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1236.558325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1131.376400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1058.462683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1018.919757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1006.929988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1000.924164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 997.057751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 992.146696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 990.467451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 990.467451 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3763.027227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1502.580970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1286.900665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1169.576206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1122.939531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1108.972049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1104.953532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1103.270073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1101.645238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1098.946203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1095.719635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1095.719635 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3634.283962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1393.174055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1064.065558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 998.290332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 973.809987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 963.302264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 949.245382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 943.582074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 942.712725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 942.090755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 941.998670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 941.998670 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 4122.006202 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1440.624472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1201.124592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1081.368683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1019.710036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 998.220181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 991.313592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 988.455638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 986.674128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 985.122136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 984.455611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 984.455611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3169.917474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1708.163015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1275.618128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1086.379758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1017.730370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 994.236230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 984.400401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 982.537214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 981.070886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 980.488255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 980.416752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 980.416752 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3805.876854 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1440.491291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1164.498683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1068.693224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1030.794446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1012.456002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1005.801464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 1003.516310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 1002.997394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 1002.812312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 1002.764592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1002.764592 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">caretmod</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>minimum occurred at one end of the range</span>
<span class="r-plt img"><img src="SensAnalysisMLP-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-5-5 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD      TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.090643 -3.244879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -2.014266  2.340029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -2.301017  3.314643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.646404  2.363488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -3.194331  4.590329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD      TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.304236  1.328709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -4.758324 -5.036435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -3.562429 -2.846620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -2.543834 -1.934337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -4.986845 -3.618596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  3.2431659  3.4280643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.9767421 -1.0853447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.3783996 -1.6561027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.1020680 -0.9648333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.7293068 -2.3794496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            WD     TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.318590 1.452776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 4.054048 4.764898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 2.825830 2.851447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.954111 1.987588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 4.062261 3.559360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -2.776717 -2.9660789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1.741819 -0.9797513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  2.658557 -1.6599594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  2.337693 -1.4494932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  3.388717 -2.1470112</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Train h2o NNET --------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create local cluster with 4 available cores</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html" class="external-link">h2o.init</a></span><span class="op">(</span>ip <span class="op">=</span> <span class="st">"localhost"</span>,</span></span>
<span class="r-in"><span>              nthreads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H2O is not running yet, starting it now...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note:  In case of errors look at the following log files:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     C:\Users\JPIZAR~1\AppData\Local\Temp\RtmpmwWafn\file16505076768e/h2o_jpizarroso_started_from_r.out</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     C:\Users\JPIZAR~1\AppData\Local\Temp\RtmpmwWafn\file16502bc75ecb/h2o_jpizarroso_started_from_r.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting H2O JVM and connecting:  Connection successful!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R is connected to the H2O cluster: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster uptime:         2 seconds 781 milliseconds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster timezone:       Europe/Madrid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O data parsing timezone:  UTC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster version:        3.44.0.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster version age:    6 months and 4 days </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster name:           H2O_started_from_R_jpizarroso_vno719 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total nodes:    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total memory:   7.91 GB </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster total cores:    20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster allowed cores:  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O cluster healthy:        TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection ip:          localhost </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection port:        54321 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Connection proxy:       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     H2O Internal Security:      FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     R Version:                  R version 4.3.3 (2024-02-29 ucrt) </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Your H2O cluster version is (6 months and 4 days) old. There may be a newer version available.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Please download and install the latest version from: https://h2o-release.s3.amazonaws.com/h2o/latest_stable.html</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reset the cluster</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html" class="external-link">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdata_h2o</span> <span class="op">&lt;-</span> <span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.h2o.html" class="external-link">as.h2o</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fdata.Reg.cl</span>, destination_frame <span class="op">=</span> <span class="st">"fdata_h2o"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h2omod</span> <span class="op">&lt;-</span> <span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html" class="external-link">h2o.deeplearning</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.cl</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                       distribution <span class="op">=</span> <span class="st">"AUTO"</span>,</span></span>
<span class="r-in"><span>                                       training_frame <span class="op">=</span> <span class="va">fdata_h2o</span>,</span></span>
<span class="r-in"><span>                                       standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                       activation <span class="op">=</span> <span class="st">"Tanh"</span>,</span></span>
<span class="r-in"><span>                                       hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">hidden_neurons</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       stopping_rounds <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                       epochs <span class="op">=</span> <span class="va">iters</span>,</span></span>
<span class="r-in"><span>                                       seed <span class="op">=</span> <span class="fl">150</span>,</span></span>
<span class="r-in"><span>                                       model_id <span class="op">=</span> <span class="st">"nnet_h2o"</span>,</span></span>
<span class="r-in"><span>                                       adaptive_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                       rate_decay <span class="op">=</span> <span class="va">decay</span>,</span></span>
<span class="r-in"><span>                                       export_weights_and_biases <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">h2omod</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in value[[3L]](cond):</span> The training data has not been detected, load the data to the h2o cluster</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apaga el cluster</span></span></span>
<span class="r-in"><span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html" class="external-link">h2o.shutdown</a></span><span class="op">(</span>prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">fdata_h2o</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## TRAIN nnet NNET --------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Create a formula to train NNET</span></span></span>
<span class="r-in"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fdata.Reg.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">form</span>, sep <span class="op">=</span> <span class="st">" ~ "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nnetmod</span> <span class="op">&lt;-</span> <span class="fu">nnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">form</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">nntrData</span>,</span></span>
<span class="r-in"><span>                      linear.output <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      size <span class="op">=</span> <span class="va">hidden_neurons</span>,</span></span>
<span class="r-in"><span>                      decay <span class="op">=</span> <span class="va">decay</span>,</span></span>
<span class="r-in"><span>                      maxit <span class="op">=</span> <span class="va">iters</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 3571.076907 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1391.280224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 1195.078969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 1148.503871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 1071.086906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 1016.236754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 1003.803225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 998.327935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 996.114736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 995.001087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 994.799975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 994.799975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-in"><span><span class="co"># Try SensAnalysisMLP</span></span></span>
<span class="r-in"><span><span class="fu">NeuralSens</span><span class="fu">::</span><span class="fu">SensAnalysisMLP</span><span class="op">(</span><span class="va">nnetmod</span>, trData <span class="op">=</span> <span class="va">nntrData</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>All aesthetics have length 1, but the data has 2 rows.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you mean to use `annotate()`?</span>
<span class="r-plt img"><img src="SensAnalysisMLP-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity analysis of 2-5-5 MLP network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1980 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivities of each output (only 5 first samples):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -2.968083 -3.6639068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -2.139224  0.1506373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.140777  0.4886891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.048007  0.4451950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -1.340015  0.5999645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              WD        TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.4553591 -0.02138749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -4.0477280 -4.37830121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -2.7435740 -2.99623805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.9237215 -1.87727229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -3.5930227 -3.96295593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              WD       TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.9192403  3.1613092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.3239739 -1.0853134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.3781555 -1.0807294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.2235086 -0.7306592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.3940855 -1.4305374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            WD      TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.122822 0.5389337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 5.718809 5.5029293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 3.804515 3.7155578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 2.744626 2.2923798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 4.900349 4.9341007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $X0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             WD        TEMP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.3345239 -0.10232568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.8188511 -0.15597407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.4793482 -0.09476533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.4662102 -0.10846099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.4495483 -0.09757113</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>NULL</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Developed by José Portela González, Antonio Muñoz San Roque, Jaime Pizarroso Gonzalo. Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>

  

  

  </body></html>

