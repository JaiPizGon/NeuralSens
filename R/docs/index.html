<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Analysis functions to quantify inputs importance in neural network models. Functions are available for calculating and plotting the inputs importance and obtaining the activation function of each neuron layer and its derivatives. The importance of a given input is defined as the distribution of the derivatives of the output with respect to that input in each training data point &lt;doi:10.18637/jss.v102.i07&gt;.">
<title>Sensitivity Analysis of Neural Networks • NeuralSens</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis of Neural Networks">
<meta property="og:description" content="Analysis functions to quantify inputs importance in neural network models. Functions are available for calculating and plotting the inputs importance and obtaining the activation function of each neuron layer and its derivatives. The importance of a given input is defined as the distribution of the derivatives of the output with respect to that input in each training data point &lt;doi:10.18637/jss.v102.i07&gt;.">
<meta property="og:image" content="https://jaipizgon.github.io/NeuralSens/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">NeuralSens</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="articles/download.html">Download</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JaiPizGon/NeuralSens/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="neuralsens-">NeuralSens <a class="anchor" aria-label="anchor" href="#neuralsens-"></a>
</h1>
</div>
<div class="section level4">
<h4 id="jaime-pizarroso-gonzalo-jpizarrosocomillasedu">
<em>Jaime Pizarroso Gonzalo, <a href="mailto:jpizarroso@comillas.edu" class="email">jpizarroso@comillas.edu</a></em><a class="anchor" aria-label="anchor" href="#jaime-pizarroso-gonzalo-jpizarrosocomillasedu"></a>
</h4>
</div>
<div class="section level4">
<h4 id="antonio-muñoz-san-roque-antoniomunoziitcomillasedu">
<em>Antonio Muñoz San Roque, <a href="mailto:Antonio.Munoz@iit.comillas.edu" class="email">Antonio.Munoz@iit.comillas.edu</a></em><a class="anchor" aria-label="anchor" href="#antonio-mu%C3%B1oz-san-roque-antoniomunoziitcomillasedu"></a>
</h4>
</div>
<div class="section level4">
<h4 id="josé-portela-gonzález-joseportelaiitcomillasedu">
<em>José Portela González, <a href="mailto:jose.portela@iit.comillas.edu" class="email">jose.portela@iit.comillas.edu</a></em><a class="anchor" aria-label="anchor" href="#jos%C3%A9-portela-gonz%C3%A1lez-joseportelaiitcomillasedu"></a>
</h4>
<!-- badges: start -->

<p>This is the development repository for the NeuralSens package. Functions within this package can be used for the analysis of neural network models created in R.</p>
<p>The development version of this package can be installed from Github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'devtools'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'JaiPizGon/NeuralSens/R'</span><span class="op">)</span></span></code></pre></div>
<p>The last version can be installed from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'NeuralSens'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bug-reports">Bug reports<a class="anchor" aria-label="anchor" href="#bug-reports"></a>
</h3>
<p>Please submit any bug reports (or suggestions) using the <a href="https://github.com/JaiPizGon/NeuralSens/issues" class="external-link">issues</a> tab of the GitHub page.</p>
</div>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>One function is available to analyze the sensitivity of a multilayer perceptron, evaluating variable importance and plotting the analysis results. A sample dataset is also provided for use with the examples. The function has S3 methods developed for neural networks from the following packages: <a href="https://cran.r-project.org/package=nnet" class="external-link">nnet</a>, <a href="https://cran.r-project.org/package=neuralnet" class="external-link">neuralnet</a>, <a href="https://cran.r-project.org/package=RSNNS" class="external-link">RSNNS</a>, <a href="https://cran.r-project.org/package=caret" class="external-link">caret</a>, <a href="https://cran.r-project.org/package=neural" class="external-link">neural</a>, <a href="https://cran.r-project.org/package=h2o" class="external-link">h2o</a> and <a href="https://cran.r-project.org/package=forecast" class="external-link">forecast</a>. Numeric inputs that describe model weights are also acceptable.</p>
<p>Start by loading the package and the sample dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JaiPizGon/NeuralSens" class="external-link">NeuralSens</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DAILY_DEMAND_TR</span><span class="op">)</span></span></code></pre></div>
<p>The <code>SensAnalysisMLP</code> function analyze the sensitivity of the output to the input and plots three graphics with information about this analysis. To calculate this sensitivity it calculates the partial derivatives of the output to the inputs using the training data. The first plot shows information between the mean and the standard deviation of the sensitivity among the training data: - if the mean is different from zero, it means that the output depends on the input because the output changes when the input change. - if the mean is nearly zero, it means that the output could not depend on the input. If the standard deviation is also near zero it almost sure that the output does not depend on the variable because for all the training data the partial derivative is zero. - if the standard deviation is different from zero it means the the output has a non-linear relation with the input because the partial derivative derivative of the output depends on the value of the input. - if the standard deviation is nearly zero it means that the output has a linear relation with the input because the partial derivative of the output does not depend on the value of the input. The second plot gives an absolute measure to the importance of the inputs, by calculating the sum of the squares of the partial derivatives of the output to the inputs. The third plot is a density plot of the partial derivatives of the output to the inputs among the training data, giving similar information as the first plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scale the data</span></span>
<span><span class="va">DAILY_DEMAND_TR</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">DAILY_DEMAND_TR</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">DAILY_DEMAND_TR</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">DAILY_DEMAND_TR</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="co"># Parameters of the neural network</span></span>
<span><span class="va">hidden_neurons</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">iters</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">decay</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="co"># create neural network</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="va">ctrl_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"boot"</span>,</span>
<span>                          savePredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          summaryFunction <span class="op">=</span> <span class="va">defaultSummary</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span> <span class="co">#For replication</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span>form <span class="op">=</span> <span class="va">DEM</span><span class="op">~</span><span class="va">TEMP</span> <span class="op">+</span> <span class="va">WD</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">DAILY_DEMAND_TR</span>,</span>
<span>                    method <span class="op">=</span> <span class="st">"nnet"</span>,</span>
<span>                    linout <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">hidden_neurons</span>,</span>
<span>                                          decay <span class="op">=</span> <span class="va">decay</span><span class="op">)</span>,</span>
<span>                    maxit <span class="op">=</span> <span class="va">iters</span>,</span>
<span>                    preProcess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"scale"</span><span class="op">)</span>,</span>
<span>                    trControl <span class="op">=</span> <span class="va">ctrl_tune</span>,</span>
<span>                    metric <span class="op">=</span> <span class="st">"RMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analysis of the neural network</span></span>
<span><span class="va">sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SensAnalysisMLP.html">SensAnalysisMLP</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --> Apart from the plot created with the <code>SensAnalysisMLP</code> function by an internal call to <code>SensitivityPlot</code>, other plots can be obtained to analyze the neural network model. If it is a forecast problem, the <code>SensTimePlot</code> function returns a plot which shows how the sensitivity of the output changes over the time of the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/SensTimePlot.html">SensTimePlot</a></span><span class="op">(</span><span class="va">sens</span>, fdata <span class="op">=</span> <span class="va">DAILY_DEMAND_TR</span>, facet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"><!-- --></p>
<p>Also, a more detailed plot about the distribution of the variables can be obtained with the <code>SensFeaturePlot</code> function. This function returns a scatter plot over a violin plot for each input variable, where each point represent a sensitivity value of a sample of the dataset. The color of each point depends on the value of the input for its corresponding sample.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/SensFeaturePlot.html">SensFeaturePlot</a></span><span class="op">(</span><span class="va">sens</span>, fdata <span class="op">=</span> <span class="va">DAILY_DEMAND_TR</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h3>
<p>Please, to cite NeuralSens in publications use:</p>
<p>Pizarroso J, Portela J, Muñoz A (2022). “NeuralSens: Sensitivity Analysis of Neural Networks.” <em>Journal of Statistical Software</em>, <em>102</em>(7), 1-36. doi: 10.18637/jss.v102.i07 (URL: <a href="https://doi.org/10.18637/jss.v102.i07" class="external-link uri">https://doi.org/10.18637/jss.v102.i07</a>).</p>
</div>
<div class="section level3">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h3>
<p>This package is released in the public domain under the General Public License <a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="external-link">GPL</a>.</p>
</div>
<div class="section level3">
<h3 id="association">Association<a class="anchor" aria-label="anchor" href="#association"></a>
</h3>
<p>Package created in the Institute for Research in Technology (IIT), <a href="https://www.iit.comillas.edu/index.php.en" class="external-link">link to homepage</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=NeuralSens" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/JaiPizGon/NeuralSens/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/JaiPizGon/NeuralSens/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing NeuralSens</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>José Portela González <br><small class="roles"> Author </small>  </li>
<li>Antonio Muñoz San Roque <br><small class="roles"> Author </small>  </li>
<li>Jaime Pizarroso Gonzalo <br><small class="roles"> Author, contributor, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=NeuralSens" class="external-link"><img src="https://www.r-pkg.org/badges/version/NeuralSens" alt="CRAN status"></a></li>
<li><a href="https://cranlogs.r-pkg.org/badges/grand-total/NeuralSens" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/NeuralSens" alt="CRAN_Download_Badge"></a></li>
<li><a href="https://github.com/JaiPizGon/NeuralSens/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/JaiPizGon/NeuralSens/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>NULL</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Developed by José Portela González, Antonio Muñoz San Roque, Jaime Pizarroso Gonzalo. Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
